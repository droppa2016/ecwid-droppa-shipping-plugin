<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Droppa Shipping App</title>
    <link rel="stylesheet" href="https://d35z3p2poghz10.cloudfront.net/ecwid-sdk/css/1.3.8/ecwid-app-ui.css" />
</head>

<body>
    <!-- Main app block START -->
    <div class="settings-page main">
        <!-- App Header Name -->

        <div class="settings-page__body settings" style="padding-bottom: 0.1px"></div>

        <div class="settings-page__body settings" style="padding-bottom: 0.1px">
            <div class="settings-page__titles settings-page__titles--left">
                <h2 class="settings-page__title">Droppa Shipping</h2>
                <!-- <div class="settings-page__subtitle">Set up the application</div> -->
            </div>
            <div class="named-area">
                <div class="named-area__header">
                    <div class="named-area__titles">

                    </div>
                    <div class="named-area__description"></div>
                    <div class="named-area__additional"></div>
                </div>
                <div class="named-area__body">

                    <div class="a-card a-card--compact">
                        <div class="a-card__paddings">
                            <div class="iconable-block">
                                <div class="iconable-block__infographics">
                                    <span class="iconable-block__icon">
                                        <svg xmlns="http://www.w3.org/2000/svg" width="56" height="56"
                                            viewBox="0 0 56 56" fill="#189dee" focusable="false">
                                            <path
                                                d="M14 22c0-.55-.45-1-1.01-1H4c-.56 0-1 .45-1 1s.45 1 1 1h8.99c.56 0 1.01-.45 1.01-1zM14 17c0-.55-.45-1-1.01-1H1c-.56 0-1 .45-1 1s.45 1 1 1h11.99c.56 0 1.01-.45 1.01-1z">
                                            </path>
                                            <path
                                                d="M55.99 28.94v-.01c-.02-.53-.25-1.01-.6-1.36l-6.03-10.81c-.53-.97-1.87-1.76-2.98-1.76H37v-4.99C37 8.9 36.1 8 35 8H7c-1.11 0-2 .9-2 2.01V14h2v-4s28 0 28 .01V41H21.9c-.48-2.84-2.93-5-5.9-5s-5.42 2.16-5.9 4.99H7.01V25H5v15.99C5 42.1 5.9 43 7 43h3.09c.48 2.84 2.93 5 5.9 5s5.43-2.16 5.9-5h18.2c.48 2.84 2.94 5 5.91 5s5.43-2.16 5.91-5H54c1.1 0 2-.89 2-1.99V28.99c0-.02 0-.03-.01-.05zM15.99 46c-2.2 0-3.99-1.79-3.99-4s1.79-4 3.99-4 3.99 1.79 3.99 4-1.78 4-3.99 4zM37 17h9.38c.38 0 1.05.39 1.23.72L52.78 27H37V17zm9 29c-2.21 0-4-1.79-4-4s1.79-4 4-4 4 1.79 4 4-1.79 4-4 4zm8-5h-2.09c-.48-2.84-2.94-5-5.91-5s-5.43 2.16-5.91 5H37V29h17v12z">
                                            </path>
                                        </svg>
                                    </span>
                                </div>
                                <div class="iconable-block__content">
                                    <div class="cta-block">
                                        <div class="cta-block__central">
                                            <div class="cta-block__title">Shipping & Delivery</div>
                                            <div class="cta-block__content">
                                                You have successfully added the Droppa Shipping App to your account.
                                                Please make sure to give your <b> store name </b> to
                                                the Droppa Admin to add it into your retail account on your behalf
                                                before using this app.
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <div class="cta-block__cta">
                                    <button type="button" id="signup" class="btn btn-primary btn-medium">
                                        <span class="svg-icon"><svg xmlns="http://www.w3.org/2000/svg"
                                                viewBox="0 0 12 12" focusable="false">
                                                <path
                                                    d="M6.712 5.314H11v1.39H6.712V11H5.267V6.706H1V5.314h4.267V1h1.446v4.314z">
                                                </path>
                                            </svg></span>
                                        <span>Sign up</span>
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- <div class="a-card a-card--compact">
                        <div class="a-card__paddings">
                            <div class="iconable-block">

                                <div class="iconable-block__content">
                                    <div class="cta-block">
                                        <div class="cta-block__central">
                                            <div class="cta-block__title"></div>
                                            <div class="cta-block__content">
                                                Lorem ipsum dolor, sit amet consectetur adipisicing elit. Distinctio
                                                atque minus quas harum. Nam labore vero minus atque, eius earum
                                                temporibus soluta ab recusandae dignissimos repellat adipisci dolorem,
                                                molestias eaque!
                                            </div>
                                        </div>

                                        <div class="cta-block__cta">
                                            <button type="button" onclick="toggleApiKeyForm()"
                                                class="btn btn-primary btn-medium">
                                                <span class="svg-icon"><svg xmlns="http://www.w3.org/2000/svg"
                                                        viewBox="0 0 12 12" focusable="false">
                                                        <path
                                                            d="M6.712 5.314H11v1.39H6.712V11H5.267V6.706H1V5.314h4.267V1h1.446v4.314z">
                                                        </path>
                                                    </svg></span>
                                                <span>Toggle Form</span>
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div> -->

                    <!-- Instructions title block START -->
                    <!-- Check input element for example of how to set data attributes to save to storage later -->

                    <div class="a-card a-card--normal" id="apiKeyForm">
                        <div class="a-card__paddings">
                            <h3 class="fieldset__note" id="updatedKeys"></h3>
                            <!-- API KEYS -->
                            <div class="titled-items-list">
                                <div class="titled-items-list__item">
                                    <div class="fieldset" style="width: 100%">
                                        <div class="fieldset__title">API Key</div>
                                        <div class="field field--medium field--filled">
                                            <span class="fieldset__svg-icon"></span>
                                            <label class="field__label">API Key</label>

                                            <!-- Instruction title input. Use data attributes as below to save and update the value to/from application storage via functions.js -->
                                            <input data-name="apiKey" data-visibility="private" type="text"
                                                class="field__input" id="api_key" tabindex="4" maxlength="64">


                                            <div class="field__placeholder">Please Enter Your API Key</div>
                                            <span class="field-state--success">
                                                <svg xmlns="http://www.w3.org/2000/svg" width="26px" height="26px"
                                                    viewBox="0 0 26 26" focusable="false">
                                                    <path
                                                        d="M5 12l5.02 4.9L21.15 4c.65-.66 1.71-.66 2.36 0 .65.67.65 1.74 0 2.4l-12.3 14.1c-.33.33-.76.5-1.18.5-.43 0-.86-.17-1.18-.5l-6.21-6.1c-.65-.66-.65-1.74 0-2.41.65-.65 1.71-.65 2.36.01z">
                                                    </path>
                                                </svg>
                                            </span>
                                            <span class="field-state--close">
                                                <svg version="1.1" xmlns="http://www.w3.org/2000/svg" x="0px" y="0px"
                                                    viewBox="0 0 16 16" enable-background="new 0 0 16 16"
                                                    xml:space="preserve" focusable="false">
                                                    <path
                                                        d="M15.6,15.5c-0.53,0.53-1.38,0.53-1.91,0L8.05,9.87L2.31,15.6c-0.53,0.53-1.38,0.53-1.91,0c-0.53-0.53-0.53-1.38,0-1.9l5.65-5.64L0.4,2.4c-0.53-0.53-0.53-1.38,0-1.91c0.53-0.53,1.38-0.53,1.91,0l5.64,5.63l5.74-5.73c0.53-0.53,1.38-0.53,1.91,0c0.53,0.53,0.53,1.38,0,1.91L9.94,7.94l5.66,5.65C16.12,14.12,16.12,14.97,15.6,15.5z">
                                                    </path>
                                                </svg>
                                            </span>
                                        </div>
                                        <div class="field__error" aria-hidden="true" style="display: none;"></div>
                                        <div class="fieldset__note" id="errorResultsAPI"></div>
                                    </div>
                                </div>
                            </div>
                            <!-- Service Keys -->
                            <div class="titled-items-list">
                                <div class="titled-items-list__item">
                                    <div class="fieldset" style="width: 100%">
                                        <div class="fieldset__title">Service Key</div>
                                        <div class="field field--medium field--filled">
                                            <span class="fieldset__svg-icon"></span>
                                            <label class="field__label">Service Key</label>

                                            <!-- Instruction title input. Use data attributes as below to save and update the value to/from application storage via functions.js -->
                                            <input data-name="serviceKey" data-visibility="private" type="text"
                                                class="field__input" id="service_key" tabindex="4" maxlength="64">


                                            <div class="field__placeholder">Please Enter Your Service Key</div>
                                            <span class="field-state--success">
                                                <svg xmlns="http://www.w3.org/2000/svg" width="26px" height="26px"
                                                    viewBox="0 0 26 26" focusable="false">
                                                    <path
                                                        d="M5 12l5.02 4.9L21.15 4c.65-.66 1.71-.66 2.36 0 .65.67.65 1.74 0 2.4l-12.3 14.1c-.33.33-.76.5-1.18.5-.43 0-.86-.17-1.18-.5l-6.21-6.1c-.65-.66-.65-1.74 0-2.41.65-.65 1.71-.65 2.36.01z">
                                                    </path>
                                                </svg>
                                            </span>
                                            <span class="field-state--close">
                                                <svg version="1.1" xmlns="http://www.w3.org/2000/svg" x="0px" y="0px"
                                                    viewBox="0 0 16 16" enable-background="new 0 0 16 16"
                                                    xml:space="preserve" focusable="false">
                                                    <path
                                                        d="M15.6,15.5c-0.53,0.53-1.38,0.53-1.91,0L8.05,9.87L2.31,15.6c-0.53,0.53-1.38,0.53-1.91,0c-0.53-0.53-0.53-1.38,0-1.9l5.65-5.64L0.4,2.4c-0.53-0.53-0.53-1.38,0-1.91c0.53-0.53,1.38-0.53,1.91,0l5.64,5.63l5.74-5.73c0.53-0.53,1.38-0.53,1.91,0c0.53,0.53,0.53,1.38,0,1.91L9.94,7.94l5.66,5.65C16.12,14.12,16.12,14.97,15.6,15.5z">
                                                    </path>
                                                </svg>
                                            </span>
                                        </div>
                                        <div class="field__error" aria-hidden="true" style="display: none;"></div>
                                        <div class="fieldset__note" id="errorResultsServiceKey"></div>
                                    </div>
                                </div>
                            </div>
                            <!-- Store Name -->
                            <div class="titled-items-list">
                                <div class="titled-items-list__item">
                                    <div class="fieldset" style="width: 100%">
                                        <div class="fieldset__title">Store Name</div>
                                        <div class="field field--medium field--filled">
                                            <span class="fieldset__svg-icon"></span>
                                            <label class="field__label">Store Name</label>

                                            <!-- Instruction title input. Use data attributes as below to save and update the value to/from application storage via functions.js -->
                                            <input data-name="storename" data-visibility="private" type="text"
                                                class="field__input" id="store_name" tabindex="4" maxlength="64">


                                            <div class="field__placeholder">Please Enter Your Store Name</div>
                                            <span class="field-state--success">
                                                <svg xmlns="http://www.w3.org/2000/svg" width="26px" height="26px"
                                                    viewBox="0 0 26 26" focusable="false">
                                                    <path
                                                        d="M5 12l5.02 4.9L21.15 4c.65-.66 1.71-.66 2.36 0 .65.67.65 1.74 0 2.4l-12.3 14.1c-.33.33-.76.5-1.18.5-.43 0-.86-.17-1.18-.5l-6.21-6.1c-.65-.66-.65-1.74 0-2.41.65-.65 1.71-.65 2.36.01z">
                                                    </path>
                                                </svg>
                                            </span>
                                            <span class="field-state--close">
                                                <svg version="1.1" xmlns="http://www.w3.org/2000/svg" x="0px" y="0px"
                                                    viewBox="0 0 16 16" enable-background="new 0 0 16 16"
                                                    xml:space="preserve" focusable="false">
                                                    <path
                                                        d="M15.6,15.5c-0.53,0.53-1.38,0.53-1.91,0L8.05,9.87L2.31,15.6c-0.53,0.53-1.38,0.53-1.91,0c-0.53-0.53-0.53-1.38,0-1.9l5.65-5.64L0.4,2.4c-0.53-0.53-0.53-1.38,0-1.91c0.53-0.53,1.38-0.53,1.91,0l5.64,5.63l5.74-5.73c0.53-0.53,1.38-0.53,1.91,0c0.53,0.53,0.53,1.38,0,1.91L9.94,7.94l5.66,5.65C16.12,14.12,16.12,14.97,15.6,15.5z">
                                                    </path>
                                                </svg>
                                            </span>
                                        </div>
                                        <div class="field__error" aria-hidden="true" style="display: none;"></div>
                                        <div class="fieldset__note" id="errorResultsStoreName"></div>
                                    </div>
                                </div>
                            </div>
                            <!-- Hidden/Disabled StoreId -->
                            <div class="titled-items-list" style="display: none;">
                                <div class="titled-items-list__item">
                                    <div class="fieldset" style="width: 100%">
                                        <div class="fieldset__title" id="fieldset__title">Store ID</div>
                                        <div class="field field--medium field--filled">
                                            <span class="fieldset__svg-icon"></span>
                                            <label class="field__label">Store ID</label>

                                            <!-- Instruction title input. Use data attributes as below to save and update the value to/from application storage via functions.js -->
                                            <input data-name="storeId" data-visibility="private" type="text"
                                                class="field__input" readonly hidden id="storeId" tabindex="4"
                                                maxlength="64">

                                            <!-- <div class="field__placeholder">Store ID is automatically loaded.</div> -->
                                            <span class="field-state--success">
                                                <svg xmlns="http://www.w3.org/2000/svg" width="26px" height="26px"
                                                    viewBox="0 0 26 26" focusable="false">
                                                    <path
                                                        d="M5 12l5.02 4.9L21.15 4c.65-.66 1.71-.66 2.36 0 .65.67.65 1.74 0 2.4l-12.3 14.1c-.33.33-.76.5-1.18.5-.43 0-.86-.17-1.18-.5l-6.21-6.1c-.65-.66-.65-1.74 0-2.41.65-.65 1.71-.65 2.36.01z">
                                                    </path>
                                                </svg>
                                            </span>
                                            <span class="field-state--close">
                                                <svg version="1.1" xmlns="http://www.w3.org/2000/svg" x="0px" y="0px"
                                                    viewBox="0 0 16 16" enable-background="new 0 0 16 16"
                                                    xml:space="preserve" focusable="false">
                                                    <path
                                                        d="M15.6,15.5c-0.53,0.53-1.38,0.53-1.91,0L8.05,9.87L2.31,15.6c-0.53,0.53-1.38,0.53-1.91,0c-0.53-0.53-0.53-1.38,0-1.9l5.65-5.64L0.4,2.4c-0.53-0.53-0.53-1.38,0-1.91c0.53-0.53,1.38-0.53,1.91,0l5.64,5.63l5.74-5.73c0.53-0.53,1.38-0.53,1.91,0c0.53,0.53,0.53,1.38,0,1.91L9.94,7.94l5.66,5.65C16.12,14.12,16.12,14.97,15.6,15.5z">
                                                    </path>
                                                </svg>
                                            </span>
                                        </div>
                                        <div class="field__error" aria-hidden="true" style="display: none;"></div>
                                        <div class="fieldset__note" id="errorResultsStoreID"></div>
                                    </div>
                                </div>
                            </div>
                            <!-- Hidden/Disabled Public Key -->
                            <div class="titled-items-list" style="display: none;">
                                <div class="titled-items-list__item">
                                    <div class="fieldset" style="width: 100%">
                                        <div class="fieldset__title" id="fieldset__title">Public Keys</div>
                                        <div class="field field--medium field--filled">
                                            <span class="fieldset__svg-icon"></span>
                                            <label class="field__label">Public Keys</label>

                                            <!-- Instruction title input. Use data attributes as below to save and update the value to/from application storage via functions.js -->
                                            <input data-name="public_key" data-visibility="private" type="text"
                                                class="field__input" readonly hidden id="public_key" tabindex="4"
                                                maxlength="64">

                                            <!-- <div class="field__placeholder">Store ID is automatically loaded.</div> -->
                                            <span class="field-state--success">
                                                <svg xmlns="http://www.w3.org/2000/svg" width="26px" height="26px"
                                                    viewBox="0 0 26 26" focusable="false">
                                                    <path
                                                        d="M5 12l5.02 4.9L21.15 4c.65-.66 1.71-.66 2.36 0 .65.67.65 1.74 0 2.4l-12.3 14.1c-.33.33-.76.5-1.18.5-.43 0-.86-.17-1.18-.5l-6.21-6.1c-.65-.66-.65-1.74 0-2.41.65-.65 1.71-.65 2.36.01z">
                                                    </path>
                                                </svg>
                                            </span>
                                            <span class="field-state--close">
                                                <svg version="1.1" xmlns="http://www.w3.org/2000/svg" x="0px" y="0px"
                                                    viewBox="0 0 16 16" enable-background="new 0 0 16 16"
                                                    xml:space="preserve" focusable="false">
                                                    <path
                                                        d="M15.6,15.5c-0.53,0.53-1.38,0.53-1.91,0L8.05,9.87L2.31,15.6c-0.53,0.53-1.38,0.53-1.91,0c-0.53-0.53-0.53-1.38,0-1.9l5.65-5.64L0.4,2.4c-0.53-0.53-0.53-1.38,0-1.91c0.53-0.53,1.38-0.53,1.91,0l5.64,5.63l5.74-5.73c0.53-0.53,1.38-0.53,1.91,0c0.53,0.53,0.53,1.38,0,1.91L9.94,7.94l5.66,5.65C16.12,14.12,16.12,14.97,15.6,15.5z">
                                                    </path>
                                                </svg>
                                            </span>
                                        </div>
                                        <div class="field__error" aria-hidden="true" style="display: none;"></div>
                                        <div class="fieldset__note"></div>
                                    </div>
                                </div>
                            </div>
                            <!-- Hidden/Disabled Private Key -->
                            <div class="titled-items-list" style="display: none;">
                                <div class="titled-items-list__item">
                                    <div class="fieldset" style="width: 100%">
                                        <div class="fieldset__title" id="fieldset__title">Private Keys</div>
                                        <div class="field field--medium field--filled">
                                            <span class="fieldset__svg-icon"></span>
                                            <label class="field__label">Private Keys</label>

                                            <!-- Instruction title input. Use data attributes as below to save and update the value to/from application storage via functions.js -->
                                            <input data-name="private_key" data-visibility="private" type="text"
                                                class="field__input" readonly hidden id="private_key" tabindex="4"
                                                maxlength="64">

                                            <!-- <div class="field__placeholder">Store ID is automatically loaded.</div> -->
                                            <span class="field-state--success">
                                                <svg xmlns="http://www.w3.org/2000/svg" width="26px" height="26px"
                                                    viewBox="0 0 26 26" focusable="false">
                                                    <path
                                                        d="M5 12l5.02 4.9L21.15 4c.65-.66 1.71-.66 2.36 0 .65.67.65 1.74 0 2.4l-12.3 14.1c-.33.33-.76.5-1.18.5-.43 0-.86-.17-1.18-.5l-6.21-6.1c-.65-.66-.65-1.74 0-2.41.65-.65 1.71-.65 2.36.01z">
                                                    </path>
                                                </svg>
                                            </span>
                                            <span class="field-state--close">
                                                <svg version="1.1" xmlns="http://www.w3.org/2000/svg" x="0px" y="0px"
                                                    viewBox="0 0 16 16" enable-background="new 0 0 16 16"
                                                    xml:space="preserve" focusable="false">
                                                    <path
                                                        d="M15.6,15.5c-0.53,0.53-1.38,0.53-1.91,0L8.05,9.87L2.31,15.6c-0.53,0.53-1.38,0.53-1.91,0c-0.53-0.53-0.53-1.38,0-1.9l5.65-5.64L0.4,2.4c-0.53-0.53-0.53-1.38,0-1.91c0.53-0.53,1.38-0.53,1.91,0l5.64,5.63l5.74-5.73c0.53-0.53,1.38-0.53,1.91,0c0.53,0.53,0.53,1.38,0,1.91L9.94,7.94l5.66,5.65C16.12,14.12,16.12,14.97,15.6,15.5z">
                                                    </path>
                                                </svg>
                                            </span>
                                        </div>
                                        <div class="field__error" aria-hidden="true" style="display: none;"></div>
                                        <div class="fieldset__note"></div>
                                    </div>
                                </div>
                            </div>
                            <div class="iconable-block__content">
                                <div class="cta-block">
                                    <!-- <div class="cta-block__central">
                                        <div class="cta-block__title"></div>
                                        <div class="cta-block__content"></div>
                                    </div> -->

                                    <div class="cta-block__cta">
                                        <button type="button" id="saveEcwidKeys" class="btn btn-primary btn-medium">
                                            <span class="svg-icon"><svg xmlns="http://www.w3.org/2000/svg"
                                                    viewBox="0 0 12 12" focusable="false">
                                                    <path
                                                        d="M6.712 5.314H11v1.39H6.712V11H5.267V6.706H1V5.314h4.267V1h1.446v4.314z">
                                                    </path>
                                                </svg></span>
                                            <span>Save Keys</span>
                                        </button>
                                    </div>

                                    <!-- <div class="cta-block__cta">
                                        <button type="button" id="viewEcwidKeys" class="btn btn-primary btn-medium">
                                            <span class="svg-icon"><svg xmlns="http://www.w3.org/2000/svg"
                                                    viewBox="0 0 12 12" focusable="false">
                                                    <path
                                                        d="M6.712 5.314H11v1.39H6.712V11H5.267V6.706H1V5.314h4.267V1h1.446v4.314z">
                                                    </path>
                                                </svg></span>
                                            <span>View my keys</span>
                                        </button>
                                    </div> -->
                                </div>
                            </div>

                        </div>
                    </div>
                    <!-- Condition block with dropdown END -->
                </div>
            </div>
        </div>
    </div>
    <!-- Main app block START -->

    <script src="https://app.ecwid.com/script.js?58231007"></script>
    <script src="https://djqizrxa6f10j.cloudfront.net/ecwid-sdk/js/1.2.8/ecwid-app.js"></script>
    <script src="https://d35z3p2poghz10.cloudfront.net/ecwid-sdk/css/1.3.8/ecwid-app-ui.min.js"></script>

    <script>

        EcwidApp.init({
            app_id: "droppa-app-dev",
            autoloadedflag: true,
            autoheight: true
        });

        console.log("app loaded......");
        let storeData = EcwidApp.getPayload();
        let storeId = storeData.store_id;
        let accessToken = storeData.access_token;
        let publicToken = storeData.public_token;
        let language = storeData.lang;
        let viewMode = storeData.view_mode;
        // const EcwidSettings = require('./model/EcwidSettings');

        const initialConfig = {
            private: {
                merchantId: "droppa--dev",
                title: "Droppa Shipping DEV",
                APIsecret: accessToken,
                endpointUrl: "https://ecwid-droppa-shipping-plugin.herokuapp.com",
                instructionTitle: "Droppa Shipping Application",
                globalShippingRate: "true",
                enabled: true,
                installed: "yes",
                fulfilmentType: "shipping",
                companyEmail: "Droppa Group",
                aboutBusiness: "Droppa is an on demand delivery service that makes it safer and easier to move office or household goods and furniture. Once you’ve booked a Droppa delivery, you will be able to track your goods throughout the entire journey, from pick up to drop off! Our drivers go through a vigorous screening and training process where all checks are conducted and drivers are taught how to handle goods in transit."
            },
            public: {
                merchantId: "droppa-app-dev",
                title: "Droppa Shipping DEV",
                fulfilmentType: "shipping",
                APIsecret: publicToken,
                endpointUrl: "https://ecwid-droppa-shipping-plugin.herokuapp.com",
                instructionTitle: "Droppa Shipping Application",
                enabled: true,
                installed: "yes"
            }
        };
        // https://my.ecwid.com/store/58231007#develop-apps
        EcwidApp.setAppStorage(accessToken, async (value) => {
            // console.log('Public User Preferences Saved:', value, accessToken, storeData)
        });

        EcwidApp.setAppPublicConfig(accessToken, () => {
            // console.log('Public app config saved!')
        });

        EcwidApp.getAppStorage('public', (value) => {
            console.log(`Installed Application: `, value);
        });

        EcwidApp.getAppStorage('api_key', function (value) {
            let api_key = document.querySelector('#api_key').value;
            console.log("api key is ....",  value);
            if (value){
                document.querySelector('#api_key').value = value;
            }else{
                console.log("no api key");
            }
        });

        EcwidApp.getAppStorage('service_key', function (value) {
            let service_key = document.querySelector('#service_key').value;
            // console.log("api key is ....",  value);
            if (value){
                document.querySelector('#service_key').value = value;
            }else{
                console.log("no api key");
            }
        });

        EcwidApp.getAppStorage('storeName', function (value) {
            let store_name = document.querySelector('#store_name').value;
            console.log("api key is ....",  value);
            if (value){
                document.querySelector('#store_name').value = value;
            }else{
                console.log("no api key");
            }
        });

        let store_Id = document.getElementById('storeId');
        let public_key = document.getElementById('public_key');
        let private_key = document.getElementById('private_key');

        store_Id.value = storeId;
        public_key.value = publicToken;
        private_key.value = accessToken;

        async function postData(url = '', data = {}) {

            const response = await fetch(url, {
                method: "POST",
                mode: 'cors', // no-cors, *cors, same-origin
                cache: 'no-cache', // *default, no-cache, reload, force-cache, only-if-cached
                credentials: 'same-origin', // include, *same-origin, omit
                headers: {
                    "Content-Type": "application/json"
                },
                redirect: "follow", // manual, *follow, error
                referrerPolicy: "no-referrer", // no-referrer, *no-referrer-when-downgrade, origin, origin-when-cross-origin, same-origin, strict-origin, strict-origin-when-cross-origin, unsafe-url
                body: JSON.stringify(data) // body data type must match "Content-Type" header
            });

            return response.json();
        }

        document.getElementById('signup').addEventListener('click', (e) => {
            window.open("https://www.droppergroup.co.za/droppa/retail-Signin");
        })

        document.getElementById('saveEcwidKeys').addEventListener('click', (e) => {
            e.preventDefault();

            let { api_key,
                service_key,
                store_name,
                errorResultsAPI,
                errorResultsServiceKey,
                errorResultsStoreName,
                errorResultsStoreId,
                updatedKeys
            } = '';

            api_key = document.querySelector('#api_key').value;
            service_key = document.querySelector('#service_key').value;
            store_name = document.querySelector('#store_name').value;
            errorResultsAPI = document.getElementById('errorResultsAPI');
            errorResultsServiceKey = document.getElementById('errorResultsServiceKey');
            errorResultsStoreName = document.getElementById('errorResultsStoreName');
            updatedKeys = document.getElementById('updatedKeys');

            const bodyData = {
                api_key: api_key,
                service_key: service_key,
                storeName: store_name,
                store_Id: `${storeId}`,
                public_key: publicToken,
                private_key: accessToken
            }

            EcwidApp.getAppStorage(function (allKeys) {
                console.log("These are the keys.......", allKeys);
            });


            console.log("This is body data......", bodyData);
            if (api_key.trim() === '') {
                errorResultsAPI.innerHTML = 'Please Fill In The API Key Field.';
                return false;

            } else if (service_key.trim() === '') {
                errorResultsAPI.innerHTML = "";
                errorResultsServiceKey.innerHTML = 'Please Fill In The Service Key Field.';
                return false;

            } else if (store_name.trim() === '') {
                errorResultsServiceKey.innerHTML = "";
                errorResultsStoreName.innerHTML = 'Please Fill In The Store Name Field.';
                return false;

            } else {

                errorResultsStoreName.innerHTML = "";
                EcwidApp.setAppStorage(bodyData, function () {
                    console.log('Data saved!');
                });

                EcwidApp.getAppStorage('public', function (value) {
                    //prints '1234' 
                    console.log(value);
                });

                // EcwidApp.getAppStorage(function (allKeys) {}

                /*EcwidApp.getAppStorage(function (allKeys) {
                    // prints an array of key : value objects from app storage
                    console.log(allKeys);
                    const saveEcwidSettings = new EcwidSettings(bodyData);

                    EcwidSettings.findOne({ store_Id: `${bodyData.store_Id}` },
                        async (error, foundStoreName) => {

                            if (error) console.log({ error });

                            if (foundStoreName === null) {
                                return await saveEcwidSettings.save((error, savedResults) => {
                                    if (error) console.log({ error });

                                    fs.writeFile("./application_saved_keys.json", bodyData, function (err, data) {
                                        if (err) {
                                            return console.log(err);
                                        }
                                        console.log(data);
                                    });

                                    if (savedResults) {
                                        res.json({
                                            updatedKeys: 'Your keys were successfully saved.',
                                            dataResponse: savedResults,
                                            status: 200
                                        });
                                    }
                                });
                            } else {
                                return await EcwidSettings.findOneAndUpdate(
                                    { store_Id: newUserModel.api_key },
                                    newUserModel,
                                    { upsert: true, new: true },
                                    async (error, results) => {
                                        if (error) console.log({ error });

                                        const storeInformation = await EcwidSettings.findOne({}).where('store_Id').equals(results.store_Id).exec();

                                        fs.writeFile("./application_saved_keys.json", bodyData, function (err, data) {
                                            if (err) {
                                                return console.log(err);
                                            }
                                            console.log(data);
                                        });

                                        res.json({
                                            updatedKeys: 'Your keys were successfully updated.',
                                            dataResponse: storeInformation,
                                            status: 200
                                        });
                                    });
                            }
                        });
                });*/

                postData("*", { bodyData })
                    .then(data => {
                        if (data.status === 200) {
                            updatedKeys.innerHTML = data.updatedKeys;
                        } else {
                            updatedKeys.innerHTML = data.updatedKeys;
                        }
                    })
                    .catch(error => {
                        console.log(error.message)
                        console.log(error);
                    });
            }
        });

    </script>
</body>

</html>